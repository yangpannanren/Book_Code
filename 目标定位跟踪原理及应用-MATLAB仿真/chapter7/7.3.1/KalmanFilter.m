%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 程序说明：2个观测站对2个目标观测跟踪程序
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% kalman滤波子程序
function [Xout,Pout]=KalmanFilter(Xin,Zin,Pin,F,G,H,Q,R)
Xpre=F*Xin;  % 状态预测
Zpre=H*Xpre; % 观测预测
Ppre=F*Pin*F'+G*Q*G'; % 协方差预测
K=Ppre*H'*inv(H*Ppre*H'+R);% 计算kalman增益
e=Zin-Zpre; % 新息
Xout=Xpre+K*e;  % 状态更新
Pout=(eye(4)-K*H)*Ppre; % 协方差更新
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%